D:/MLOps/dataset/
[2021-10-23 01:32:18,769][tensorflow][INFO] - Load image with size: 7553, num_label: 2, labels: with_mask, without_mask.
[2021-10-23 01:32:18,771][tensorflow][INFO] - Retraining the models...
[2021-10-23 01:32:18,773][absl][INFO] - Using C:\Users\phant\AppData\Local\Temp\tfhub_modules to cache modules.
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
hub_keras_layer_v1v2 (HubKer (None, 1280)              2257984
_________________________________________________________________
dropout (Dropout)            (None, 1280)              0
_________________________________________________________________
dense (Dense)                (None, 2)                 2562
=================================================================
Total params: 2,260,546
Trainable params: 2,562
Non-trainable params: 2,257,984
_________________________________________________________________
None
Epoch 1/10
C:\Users\phant\.virtualenvs\MLOps-he8T28m9\lib\site-packages\keras\optimizer_v2\optimizer_v2.py:355: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  warnings.warn(








188/188 [==============================] - 27s 119ms/step - loss: 0.2778 - accuracy: 0.9712 - val_loss: 0.2297 - val_accuracy: 0.9932
Epoch 2/10








188/188 [==============================] - 21s 112ms/step - loss: 0.2338 - accuracy: 0.9934 - val_loss: 0.2265 - val_accuracy: 0.9932
Epoch 3/10








188/188 [==============================] - 21s 112ms/step - loss: 0.2286 - accuracy: 0.9947 - val_loss: 0.2263 - val_accuracy: 0.9932
Epoch 4/10








188/188 [==============================] - 21s 112ms/step - loss: 0.2245 - accuracy: 0.9965 - val_loss: 0.2252 - val_accuracy: 0.9905
Epoch 5/10








188/188 [==============================] - 21s 112ms/step - loss: 0.2251 - accuracy: 0.9958 - val_loss: 0.2269 - val_accuracy: 0.9905
Epoch 6/10








188/188 [==============================] - 22s 115ms/step - loss: 0.2234 - accuracy: 0.9965 - val_loss: 0.2266 - val_accuracy: 0.9905
Epoch 7/10








188/188 [==============================] - 21s 113ms/step - loss: 0.2222 - accuracy: 0.9975 - val_loss: 0.2266 - val_accuracy: 0.9932
Epoch 8/10








188/188 [==============================] - 21s 113ms/step - loss: 0.2210 - accuracy: 0.9965 - val_loss: 0.2233 - val_accuracy: 0.9932
Epoch 9/10








188/188 [==============================] - 21s 113ms/step - loss: 0.2208 - accuracy: 0.9978 - val_loss: 0.2238 - val_accuracy: 0.9932
Epoch 10/10









188/188 [==============================] - 23s 122ms/step - loss: 0.2211 - accuracy: 0.9970 - val_loss: 0.2246 - val_accuracy: 0.9932
24/24 [==============================] - 6s 102ms/step - loss: 0.2272 - accuracy: 0.9934
0.22721482813358307
0.9933862686157227
Error executing job with overrides: []
Traceback (most recent call last):
  File "D:\MLOps\FMClassifier\train.py", line 52, in main
    model.export(export_dir='D:\MLOps\models',tflite_filename='{model}_{day}.tflite'.format(day = datetime.date.today(),model=cfg.model.model_spec), quantization_config=config)
omegaconf.errors.ConfigAttributeError: Key 'model_spec' is not in struct
    full_key: model.model_spec
    object_type=dict
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.